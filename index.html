<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>MindBloow ‚Äî Interactive</title>
  <meta name="description" content="Edukasi, Tes, dan Konsultasi AI untuk kesehatan mental.">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* ================= GAYA TAMPILAN (DESIGN V1.5) ================= */
    :root {
        --bg: #F0F4F8;
        --card: #ffffff;
        --primary: #4F73FF;
        --primary-dark: #3a5bcc;
        --accent: #FF6B95;
        --text: #1E293B;
        --muted: #64748B;
        --radius: 16px;
        --font: 'Poppins', sans-serif;
        --shadow: 0 10px 40px -10px rgba(79, 115, 255, 0.15);
    }

    * { box-sizing: border-box; }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: var(--font); min-height: 100vh; overflow-x: hidden; }

    /* LAYOUT */
    .site { display: flex; flex-direction: column; min-height: 100vh; }
    main { flex: 1; max-width: 1000px; margin: 90px auto 20px; padding: 20px; width: 100%; }

    /* NAVBAR GLASSMORPHISM */
    header.navbar {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(16px);
        padding: 15px 20px;
        position: fixed;
        top: 0; left: 0; right: 0; z-index: 1000;
        border-bottom: 1px solid rgba(255,255,255,0.3);
        box-shadow: 0 4px 20px rgba(0,0,0,0.03);
    }
    .nav-inner { max-width: 1000px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
    .logo { font-weight: 800; font-size: 22px; color: var(--primary); letter-spacing: -0.5px; }

    /* MENU */
    .menu { display: flex; gap: 6px; }
    .nav-box { text-decoration: none; padding: 8px 14px; border-radius: 8px; color: var(--muted); font-weight: 600; font-size: 14px; transition: all 0.3s; }
    .nav-box:hover { background: #EFF6FF; color: var(--primary); }
    .nav-box[aria-current="true"] { background: var(--primary); color: white; box-shadow: 0 4px 12px rgba(79, 115, 255, 0.4); }

    /* HERO SECTION */
    .hero { display: flex; align-items: center; gap: 40px; background: #fff; overflow: hidden; position: relative; }
    .hero::before { content:''; position:absolute; top:-50px; right:-50px; width:200px; height:200px; background:linear-gradient(45deg, #eef6ff, #fff0f6); border-radius:50%; z-index:0; }
    .hero-text { flex: 1; z-index: 1; }
    .badge-new { display: inline-block; background: #ffebf0; color: var(--accent); padding: 4px 12px; border-radius: 50px; font-size: 12px; font-weight: 700; margin-bottom: 15px; }
    .hero h1 { font-size: 2.5rem; line-height: 1.2; margin: 0 0 15px 0; color: #0f172a; }
    .illus-svg { width: 100%; height: auto; transform: scale(1.05); }

    /* CARDS & GRID */
    .card { background: var(--card); padding: 30px; border-radius: var(--radius); box-shadow: var(--shadow); margin-bottom: 25px; border: 1px solid #fff; }
    .grid { display: grid; gap: 20px; }
    .grid.cols-3 { grid-template-columns: repeat(3, 1fr); }
    .card-mini { background: #f8fafc; padding: 20px; border-radius: 12px; border: 1px solid #f1f5f9; transition: transform 0.2s; }
    .card-mini:hover { transform: translateY(-5px); border-color: #e2e8f0; }

    /* BUTTONS & CHIPS */
    .chip { padding: 12px 20px; border-radius: 50px; border: 1px solid #e2e8f0; background: white; cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.2s; display: inline-flex; align-items: center; justify-content: center; gap: 8px; }
    .chip:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .chip.primary-chip { background: var(--primary); color: white; border: none; box-shadow: 0 4px 15px rgba(79, 115, 255, 0.3); }
    .chip.primary-chip:hover { background: var(--primary-dark); }

    /* PULSE ANIMATION */
    .btn-pulse { animation: pulse 2s infinite; }
    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(79, 115, 255, 0.7); }
        70% { box-shadow: 0 0 0 10px rgba(79, 115, 255, 0); }
        100% { box-shadow: 0 0 0 0 rgba(79, 115, 255, 0); }
    }

    /* SPA PAGES */
    .page { display: none; animation: fadeIn 0.4s ease; }
    .page.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* QUIZ STYLES */
    .progress-container { margin-bottom: 25px; }
    .progress-label { font-size: 12px; font-weight: 600; color: var(--muted); margin-bottom: 5px; }
    .progress-bar { background: #f1f5f9; height: 8px; border-radius: 10px; overflow: hidden; }
    .progress-bar i { display: block; height: 100%; background: var(--primary); width: 0%; transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
    .choice { width: 100%; padding: 15px; margin-bottom: 10px; border: 2px solid #f1f5f9; border-radius: 12px; background: #fff; text-align: left; font-weight: 500; cursor: pointer; transition: 0.2s; }
    .choice:hover { border-color: var(--primary); background: #f8fbff; }
    .choice.selected { border-color: var(--primary); background: var(--primary); color: white; }

    /* LOADING SPINNER */
    .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    /* CHAT STYLES */
    .chat-header { border-bottom: 1px solid #f1f5f9; padding-bottom: 15px; margin-bottom: 15px; }
    .history { height: 320px; overflow-y: auto; padding: 10px; background: #F8FAFC; border-radius: 12px; margin-bottom: 15px; display: flex; flex-direction: column; gap: 12px; }
    .bubble { padding: 12px 16px; border-radius: 14px; font-size: 14px; line-height: 1.5; max-width: 85%; box-shadow: 0 2px 5px rgba(0,0,0,0.03); }
    .bubble.bot { background: #fff; color: var(--text); align-self: flex-start; border-bottom-left-radius: 2px; }
    .bubble.user { background: var(--primary); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
    .input-row { display: flex; gap: 8px; margin-top: 10px; }
    .input-row input { flex: 1; padding: 12px 15px; border: 1px solid #e2e8f0; border-radius: 50px; outline: none; font-family: var(--font); }

    /* EDU ACCORDION */
    .disorder { border: 1px solid #f1f5f9; margin-bottom: 12px; padding: 18px; border-radius: 12px; transition: 0.3s; background: #fff; }
    .disorder.open { border-color: var(--primary); box-shadow: 0 4px 20px rgba(79, 115, 255, 0.1); }
    .disorder-header { display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
    .disorder h3 { margin: 0 0 6px 0; font-size: 16px; }
    .disorder .meta { color: var(--muted); font-size: 14px; margin-bottom: 8px; }
    .more { display: none; margin-top: 15px; padding-top: 15px; border-top: 1px dashed #e2e8f0; color: #475569; font-size: 14px; }
    .disorder.open .more { display: block; animation: slideDown 0.3s ease; }
    @keyframes slideDown { from {opacity:0; transform:translateY(-5px)} to {opacity:1; transform:translateY(0)} }
    .toggle { background:none; border:none; color:var(--primary); font-weight:600; cursor:pointer; font-size:13px; }

    /* LISTS */
    .styled-list { padding-left: 20px; }
    .styled-list li { margin-bottom: 12px; padding-left: 5px; }

    /* RESPONSIVE */
    .nav-toggle { display: none; background: transparent; border: 0; flex-direction: column; gap: 5px; cursor: pointer; }
    .nav-toggle .bar { width: 25px; height: 3px; background: var(--text); border-radius: 3px; }

    @media (max-width: 800px) {
        /* NAVIGASI */
        .nav-inner { width: 95%; } 
        .nav-toggle { display: flex; }
        .menu { display: none; flex-direction: column; position: absolute; top: 75px; right: 20px; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); width: 220px; z-index: 999; }
        .menu.open { display: flex; }

        /* LAYOUT UTAMA */
        main { 
            max-width: 100%; 
            padding: 15px; 
            margin-top: 75px; 
        }
        
        /* HERO SECTION */
        .hero { 
            flex-direction: column; 
            text-align: center; 
            padding: 30px 15px; 
        }
        .hero-text {
            order: 1;
            padding-bottom: 20px;
        }
        .illustration {
            order: 2;
            width: 100%;
            max-width: 90%;
            margin: 0 auto;
        }
        .hero h1 { font-size: 2rem; }

        /* GRID & CARDS */
        .grid.cols-3 { grid-template-columns: 1fr; }
        
        /* CHAT INPUT */
        .quick-replies {
            display: flex;
            flex-wrap: wrap; 
            gap: 8px;
            margin-bottom: 10px;
        }
        .quick-replies .chip {
            flex-grow: 1; 
        }
    }
    
    /* Penyesuaian untuk layar sangat kecil */
    @media (max-width: 500px) {
        .illustration {
            display: none; 
        }
        .hero {
            padding: 40px 15px;
        }
        .hero-text {
            padding-bottom: 0;
        }
        .quick-replies .chip {
            flex-grow: 0; 
            min-width: 45%; 
        }
        .chat-input-area {
            padding-bottom: 10px;
        }
    }
  </style>
</head>
<body>
  <div class="site">
    <header class="navbar">
      <div class="nav-inner">
        <div class="brand">
          <div class="logo">MindBloow<span style="color:var(--accent)">.ai</span></div>
        </div>
        <nav>
          <div class="nav-links menu" role="tablist">
            <a class="nav-box" href="#" data-page="home" aria-current="true">Beranda</a>
            <a class="nav-box" href="#" data-page="edu">Edukasi</a>
            <a class="nav-box" href="#" data-page="signs">Tanda-tanda</a>
            <a class="nav-box" href="#" data-page="help">Cara Mengatasi</a>
            <a class="nav-box" href="#" data-page="test">Tes Mental</a>
            <a class="nav-box" href="#" data-page="consult">Konsultasi</a>
          </div>
          <button class="nav-toggle" aria-label="Buka menu">
            <span class="bar"></span><span class="bar"></span><span class="bar"></span>
          </button>
        </nav>
      </div>
    </header>

    <main>
      <section id="home" class="page active">
        <div class="hero card">
          <div class="hero-text">
            <span class="badge-new">Versi Demo 1.5</span>
            <h1>Jaga Kesehatan Mentalmu</h1>
            <p>Self-screening, edukasi, dan dukungan awal berbasis pola ‚Äî demo AI ringan.</p>
            <div class="hero-buttons" style="margin-top: 20px;">
              <button data-page="test" class="chip primary-chip btn-pulse">Mulai Tes Sekarang</button> 
              <button data-page="consult" class="chip">Konsultasi Sekarang</button>
            </div>
          </div>
          <div class="illustration">
            <svg class="illus-svg" viewBox="0 0 560 360" xmlns="http://www.w3.org/2000/svg">
              <defs><linearGradient id="g1" x1="0" x2="1"><stop offset="0" stop-color="#E8F4FF"/><stop offset="1" stop-color="#FFF0F6"/></linearGradient></defs>
              <rect x="0" y="0" width="560" height="360" rx="24" fill="url(#g1)" />
              <g transform="translate(40,40)">
                <circle cx="460" cy="60" r="40" fill="#fff" opacity="0.5" />
                <ellipse cx="220" cy="140" rx="100" ry="90" fill="#FFF" opacity="0.9" />
                <circle cx="120" cy="120" r="40" fill="#FFDEE9" opacity="0.9" />
                <path d="M150 260c20-10 180-10 200 0" stroke="#4f73ff" stroke-width="4" stroke-linecap="round" opacity="0.2"/>
              </g>
            </svg>
          </div>
        </div>
      </section>

      <section id="edu" class="page">
        <div class="card">
          <div class="section-header">
            <h2>Edukasi Lengkap</h2>
            <p class="muted">Ringkasan kondisi kesehatan mental umum.</p>
          </div>
          
          <div class="edu-container">
            <div class="grid cols-3">
              <div class="card-mini"><h3>Depresi</h3><p>Gangguan suasana hati yang menurunkan energi dan minat.</p></div>
              <div class="card-mini"><h3>Kecemasan</h3><p>Khawatir berlebih yang mengganggu aktivitas harian.</p></div>
              <div class="card-mini"><h3>Burnout</h3><p>Kelelahan kronis akibat tekanan yang berkepanjangan.</p></div>
            </div>

            <div class="disorders" id="disordersList" style="margin-top:24px;">
              <article class="disorder">
                <div class="disorder-header"><h3>1. Depresi (Gangguan Depresif Mayor)</h3><button class="toggle">Buka detail</button></div>
                <div class="meta">Definisi singkat: Gangguan suasana hati persisten yang menyebabkan perasaan sedih, kehilangan minat, dan penurunan energi yang signifikan.</div>
                <div class="more">
                   <strong>Gejala umum:</strong>
                   <ul>
                     <li>Perasaan sedih, hampa, atau putus asa hampir setiap hari</li>
                     <li>Hilangnya minat atau kesenangan pada aktivitas yang biasanya dinikmati</li>
                     <li>Perubahan berat badan atau nafsu makan</li>
                     <li>Gangguan tidur (insomnia atau tidur berlebihan)</li>
                     <li>Kesulitan berkonsentrasi dan energi menurun</li>
                   </ul>
                   <strong>Saran awal:</strong> Cari dukungan sosial dan pertimbangkan konsultasi profesional.
                </div>
              </article>

              <article class="disorder">
                <div class="disorder-header"><h3>2. Kecemasan (Gangguan Kecemasan Umum)</h3><button class="toggle">Buka detail</button></div>
                <div class="meta">Definisi singkat: Perasaan khawatir dan ketegangan yang berlebihan, tidak proporsional, dan sulit dikendalikan tentang kejadian sehari-hari.</div>
                <div class="more">
                   <strong>Gejala umum:</strong>
                   <ul>
                     <li>Kekhawatiran yang berlebihan dan konstan tentang berbagai hal</li>
                     <li>Gelisah, ketegangan otot, mudah lelah</li>
                     <li>Kesulitan berkonsentrasi dan gangguan tidur</li>
                   </ul>
                   <strong>Saran awal:</strong> Latihan pernapasan, relaksasi progresif, dan manajemen stres.
                </div>
              </article>

              <article class="disorder">
                <div class="disorder-header"><h3>3. Burnout (Kelelahan Emosional)</h3><button class="toggle">Buka detail</button></div>
                <div class="meta">Definisi singkat: Kondisi kelelahan fisik, emosional, dan mental yang ekstrem akibat stres kerja jangka panjang dan intens.</div>
                <div class="more">
                   <strong>Gejala umum:</strong>
                   <ul>
                     <li>Kelelahan kronis yang tidak hilang setelah istirahat</li>
                     <li>Sinisme atau jarak emosional terhadap pekerjaan</li>
                     <li>Penurunan produktivitas dan perasaan tidak kompeten</li>
                   </ul>
                   <strong>Saran awal:</strong> Atur batasan kerja (boundary) dan ambil waktu istirahat (cuti).
                </div>
              </article>

              <article class="disorder">
                <div class="disorder-header"><h3>4. Gangguan Bipolar</h3><button class="toggle">Buka detail</button></div>
                <div class="meta">Definisi singkat: Gangguan suasana hati yang ditandai dengan perubahan ekstrem antara episode manik (sangat gembira/enerjik) dan depresif.</div>
                <div class="more">
                    <strong>Gejala umum:</strong> Perubahan mood yang jelas dan berbeda dari perilaku biasanya.
                </div>
              </article>
            </div>
          </div>
        </div>
      </section>

      <section id="signs" class="page">
        <div class="card">
          <h2>Tanda-tanda yang Perlu Diperhatikan</h2>
          <p class="muted">Berikut adalah tanda-tanda umum yang bisa muncul ketika seseorang mengalami tekanan emosional.</p>
          <ol class="styled-list">
            <li><strong>Kehilangan energi:</strong> Kelelahan berkepanjangan, meskipun tidak melakukan aktivitas berat.</li>
            <li><strong>Menarik diri:</strong> Mulai menghindari teman, keluarga, atau kegiatan sosial.</li>
            <li><strong>Mood berubah tiba-tiba:</strong> Perubahan suasana hati yang drastis ‚Äî mudah marah, sedih tiba-tiba.</li>
            <li><strong>Kesulitan tidur:</strong> Insomnia, sering terbangun, atau sebaliknya tidur berlebihan.</li>
            <li><strong>Kekhawatiran yang berlebihan:</strong> Merasa gelisah terus menerus, memikirkan hal negatif secara berulang.</li>
            <li><strong>Sakit fisik yang tidak jelas:</strong> Sakit kepala, tegang otot, nyeri dada ringan tanpa penyebab medis.</li>
          </ol>
        </div>
      </section>

      <section id="help" class="page">
        <div class="card">
          <h2>Cara Mengatasi ‚Äî Panduan Lengkap</h2>
          <ol class="styled-list">
            <li><strong>Curhat kepada teman yang dipercaya:</strong> Membagikan perasaan dapat membuat beban emosional terasa lebih ringan.</li>
            <li><strong>Istirahat yang cukup:</strong> Tidur 7‚Äì9 jam per malam untuk pemulihan.</li>
            <li><strong>Melakukan journaling:</strong> Menuliskan emosi untuk memproses perasaan.</li>
            <li><strong>Fokus pada pola makan sehat:</strong> Konsumsi makanan seimbang membantu stabilitas mood.</li>
            <li><strong>Terlibat dalam aktivitas fisik:</strong> Olahraga ringan meningkatkan hormon perasaan positif.</li>
            <li><strong>Latih teknik relaksasi:</strong> Cobalah pernapasan 4‚Äì4‚Äì4 atau grounding 5-4-3-2-1.</li>
          </ol>
        </div>
      </section>

      <section id="test" class="page">
        <div class="card quiz-card">
          <h2>Tes Interaktif (GAD-like singkat)</h2>
          <p class="muted">Pilih jawaban untuk setiap pertanyaan ‚Äî hasil bersifat indikatif, bukan diagnosis.</p>
          
          <div class="progress-container">
            <div class="progress-label">Progress</div>
            <div class="progress-bar"><i id="progressFill"></i></div>
          </div>
          
          <div id="qArea"></div>

          <div id="loadingOverlay" style="display:none; text-align:center; padding:30px;">
            <div class="spinner"></div>
            <p>AI sedang menganalisis pola jawabanmu...</p>
          </div>
          
          <div class="quiz-controls">
            <button id="prevQ" class="chip secondary" style="display:none">Kembali</button>
            <button id="nextQ" class="chip primary-chip">Lanjut</button>
          </div>
          
          <div id="resultBox" class="result slide-up" style="display:none"></div>
        </div>
      </section>

      <section id="consult" class="page">
        <div class="card chat-container">
          <div class="chat-header">
            <div style="display:flex;align-items:center;gap:10px;">
              <div class="avatar-bot">AI</div>
              <div>
                <h2 style="margin:0;font-size:18px;">MindBloow Assistant</h2>
                <small style="color:#4ade80">‚óè Online</small>
              </div>
            </div>
          </div>
          
          <div id="history" class="history" aria-live="polite">
            <div class="bubble bot">Halo! Aku MindBloow AI. Aku di sini untuk mendengarkan tanpa menghakimi. Apa yang sedang kamu rasakan?</div>
          </div>
          
          <div class="chat-input-area">
            <div class="quick-replies">
              <button class="chip quick" data-q="cemas">Saya cemas üò∞</button>
              <button class="chip quick" data-q="sedih">Saya sedih üò¢</button>
              <button class="chip quick" data-q="tidur">Sulit tidur üò¥</button>
            </div>
            <div class="input-row">
              <input id="story" type="text" placeholder="Ketik pesanmu di sini..." autocomplete="off">
              <button id="sendBtn" class="chip primary-chip">Kirim</button>
            </div>
            <div style="text-align:right; margin-top:5px;">
              <button id="clearBtn" style="background:none;border:none;color:#999;font-size:12px;cursor:pointer;">Hapus Chat</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <small>¬© 2025 MindBloow ‚Äî Demo Kompetisi.</small>
    </footer>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      
      /* --- 1. NAVIGASI SISTEM (SPA) --- */
      const buttons = document.querySelectorAll('[data-page]');
      const pages = document.querySelectorAll('.page');
      const menu = document.querySelector('.menu');
      const navToggle = document.querySelector('.nav-toggle');

      function showPage(pageId) {
        pages.forEach(p => {
          p.classList.remove('active');
          if (p.id === pageId) p.classList.add('active');
        });

        buttons.forEach(b => {
          b.setAttribute('aria-current', b.dataset.page === pageId ? 'true' : 'false');
        });

        if (window.innerWidth < 900) {
          menu.classList.remove('open');
          menu.style.display = ''; 
        }
        
        window.scrollTo({ top: 0, behavior: 'smooth' });

        if (pageId === 'test') {
           const qContent = document.getElementById('qArea');
           if (qContent.innerHTML.trim() === '') {
              initQuiz();
           }
        }
      }

      buttons.forEach(b => b.addEventListener('click', (e) => {
        e.preventDefault();
        showPage(b.dataset.page);
      }));

      navToggle.addEventListener('click', (e) => {
        e.stopPropagation();
        const isOpen = menu.classList.toggle('open');
        menu.style.display = isOpen ? 'flex' : 'none';
      });

      document.addEventListener('click', (e) => {
        if (!menu.contains(e.target) && !navToggle.contains(e.target) && window.innerWidth < 900) {
          menu.classList.remove('open');
          menu.style.display = 'none';
        }
      });

      showPage('home');

      /* --- 2. SISTEM KUIS (GAD-like Singkat) --- */
      // Disesuaikan agar semua pertanyaan memiliki bobot 1 untuk Total Maksimal 21
      const questions = [
        { text: 'Merasa gugup, gelisah, atau tegang?', weight: 1 },
        { text: 'Tidak dapat berhenti atau mengendalikan kekhawatiran?', weight: 1 },
        { text: 'Khawatir berlebihan tentang berbagai hal?', weight: 1 },
        { text: 'Sulit santai?', weight: 1 },
        { text: 'Sulit untuk berhenti merasa khawatir?', weight: 1 },
        { text: 'Sulit untuk tidur karena kecemasan?', weight: 1 },
        { text: 'Kehilangan minat karena khawatir terus?', weight: 1 }
      ];
      // Total Maksimum Skor: 7 pertanyaan * 3 (nilai maks per jawaban) * 1 (bobot) = 21

      let currentIdx = 0;
      let answers = new Array(questions.length).fill(null);

      const qArea = document.getElementById('qArea');
      const prevBtn = document.getElementById('prevQ');
      const nextBtn = document.getElementById('nextQ');
      const progressBar = document.getElementById('progressFill');
      const resultBox = document.getElementById('resultBox');
      const loadingOverlay = document.getElementById('loadingOverlay');

      function initQuiz() {
        currentIdx = 0;
        answers.fill(null);
        resultBox.style.display = 'none';
        loadingOverlay.style.display = 'none';
        qArea.style.display = 'block';
        document.querySelector('.quiz-controls').style.display = 'flex';
        renderQuestion();
      }

      function renderQuestion() {
        qArea.innerHTML = '';
        const qData = questions[currentIdx];
        
        const title = document.createElement('h3');
        title.innerText = `${currentIdx + 1}. ${qData.text}`;
        title.style.marginBottom = '20px';
        qArea.appendChild(title);

        const choicesDiv = document.createElement('div');
        choicesDiv.className = 'choices';
        // Nilai jawaban: 0, 1, 2, 3
        const options = ['Tidak sama sekali (0)', 'Beberapa hari (1)', 'Lebih dari setengah hari (2)', 'Hampir setiap hari (3)'];
        
        options.forEach((optText, indexVal) => {
          const btn = document.createElement('button');
          btn.className = 'choice';
          btn.innerText = optText;
          
          if (answers[currentIdx] === indexVal) btn.classList.add('selected');
          
          btn.onclick = function() {
            answers[currentIdx] = indexVal;
            const siblings = choicesDiv.querySelectorAll('.choice');
            siblings.forEach(sb => sb.classList.remove('selected'));
            btn.classList.add('selected');
          };
          choicesDiv.appendChild(btn);
        });
        qArea.appendChild(choicesDiv);

        const percent = ((currentIdx) / questions.length) * 100;
        progressBar.style.width = percent + '%';
        
        prevBtn.style.display = currentIdx === 0 ? 'none' : 'inline-flex';
        nextBtn.innerText = currentIdx === questions.length - 1 ? 'Selesai & Analisis' : 'Lanjut';
      }

      nextBtn.addEventListener('click', () => {
        if (answers[currentIdx] === null) { alert("Mohon pilih jawaban terlebih dahulu."); return; }
        
        if (currentIdx < questions.length - 1) {
          currentIdx++; renderQuestion();
        } else {
          startAnalysisSimulation();
        }
      });

      prevBtn.addEventListener('click', () => {
        if (currentIdx > 0) { currentIdx--; renderQuestion(); }
      });

      function startAnalysisSimulation() {
        qArea.style.display = 'none';
        document.querySelector('.quiz-controls').style.display = 'none';
        loadingOverlay.style.display = 'block'; 
        progressBar.style.width = '100%';

        setTimeout(() => {
          loadingOverlay.style.display = 'none';
          calculateResult();
        }, 1500);
      }

      function calculateResult() {
        let totalScore = 0;
        let maxPossible = 0;
        let resultDetail = '';
        
        answers.forEach((ans, i) => {
          // Nilai Jawaban (0-3) * Bobot (1)
          const score = ans * questions[i].weight;
          totalScore += score;
          maxPossible += (3 * questions[i].weight);
        });

        // Kategori Skor (Disesuaikan dengan GAD-7 Scale, Max 21):
        // 0-4 = Minimal; 5-9 = Mild; 10-14 = Moderate; 15-21 = Severe
        const scoreMin = 0;
        const scoreMild = 5;
        const scoreModerate = 10;
        const scoreSevere = 15;

        let cat = '', msg = '', color = '';
        
        if (totalScore >= scoreSevere) {
          cat = 'Tinggi (Kritis) üî¥';
          msg = 'Skor ini mengindikasikan tingkat kecemasan yang *sangat signifikan* dan mengganggu fungsi harian Anda. Saran Penanganan: Wajib mencari bantuan profesional (psikolog/psikiater) segera.';
          color = '#fee2e2'; 
          resultDetail = `Skor Anda: ${totalScore}/${maxPossible}. Kategori: Severe Anxiety (Kecemasan Parah).`;
        } else if (totalScore >= scoreModerate) {
          cat = 'Sedang (Waspada) üü†';
          msg = 'Anda mungkin mengalami tingkat kecemasan yang cukup mengganggu. Saran Penanganan: Sangat disarankan untuk memulai konseling atau terapi bicara, serta menerapkan teknik relaksasi rutin.';
          color = '#ffedd5'; 
          resultDetail = `Skor Anda: ${totalScore}/${maxPossible}. Kategori: Moderate Anxiety (Kecemasan Sedang).`;
        } else if (totalScore >= scoreMild) {
          cat = 'Ringan (Pantau) üü°';
          msg = 'Gejala kecemasan Anda ringan dan tidak mengganggu secara substansial. Saran Penanganan: Fokus pada rutinitas tidur, olahraga, dan journaling untuk memantau emosi. Pertimbangkan konseling jika gejala memburuk.';
          color = '#fffbeb'; 
          resultDetail = `Skor Anda: ${totalScore}/${maxPossible}. Kategori: Mild Anxiety (Kecemasan Ringan).`;
        } else {
          cat = 'Minimal (Sehat) üü¢';
          msg = 'Kesehatan mental Anda tampak terjaga dengan baik. Saran Penanganan: Pertahankan pola hidup sehat (tidur, nutrisi, olahraga) dan gunakan MindBloow AI untuk self-check secara berkala.';
          color = '#dcfce7'; 
          resultDetail = `Skor Anda: ${totalScore}/${maxPossible}. Kategori: Minimal Anxiety (Kecemasan Minimal).`;
        }

        resultBox.style.display = 'block';
        resultBox.style.backgroundColor = color;
        resultBox.innerHTML = `
          <h3 style="margin-top:0">Hasil Tes: ${cat}</h3>
          <p style="font-size:15px; line-height:1.6">${msg}</p>
          <p style="font-size:14px; margin-top:15px;">Detail Skor: ${resultDetail}</p>
          <hr style="border:0; border-top:1px dashed rgba(0,0,0,0.1); margin:15px 0;">
          <div style="display:flex; gap:10px; justify-content:flex-end">
            <button id="btnRetake" class="chip">Ulangi Tes</button>
            <button id="btnChat" class="chip primary-chip">Konsultasi</button>
          </div>`;
        
        document.getElementById('btnRetake').onclick = initQuiz;
        document.getElementById('btnChat').onclick = () => showPage('consult');
      }

      /* --- 3. CHATBOT (LOGIKA SESUAI FILE AWAL) --- */
      const history = document.getElementById('history');
      const storyInput = document.getElementById('story');
      const sendBtn = document.getElementById('sendBtn');
      const clearBtn = document.getElementById('clearBtn');
      
      const avatarBot = `<div style="width: 35px; height: 35px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 12px;">AI</div>`;

      function addBubble(text, type) {
        const d = document.createElement('div');
        d.className = `bubble ${type}`;
        d.innerHTML = text;
        history.appendChild(d);
        history.scrollTo({ top: history.scrollHeight, behavior: 'smooth' });
      }

      async function processAI(text) {
        const t = text.toLowerCase();
        const id = 'typing-'+Date.now();
        
        addBubble('<span id="'+id+'">Sedang mengetik...</span>', 'bot');
        const randomDelay = Math.floor(Math.random() * 500) + 500;
        await new Promise(r => setTimeout(r, randomDelay));
        const typingEl = document.getElementById(id);
        if(typingEl) typingEl.parentElement.remove();

        // Logic Safety Check & Groups dari file awal
        const cues = ['bunuh','bunuh diri','ingin mati','meninggal','takut hidup','gak mau hidup','tidak mau hidup','sudah menyerah','mengakhiri hidup'];
        if (cues.some(c => t.includes(c))) {
            addBubble("‚ö†Ô∏è <strong>Pesan Keselamatan:</strong> Aku mendengar kalimat yang membuatku khawatir. Jika kamu berpikir untuk menyakiti diri sendiri, tolong hubungi layanan darurat 119 atau orang terdekat.", 'bot');
            return;
        }

        if (t.includes('sedih') || t.includes('nangis') || t.includes('galau')) {
            addBubble("Aku ikut sedih mendengar itu. Perasaan sedih itu valid ‚Äî kamu tidak sendiri. Mau cerita lebih lanjut?", 'bot');
        } else if (t.includes('cemas') || t.includes('khawatir') || t.includes('panik')) {
            addBubble("Terlihat kamu merasa cemas. Coba latihan pernapasan 4-4-4 sekarang jika kamu mau. Ingin aku pandu?", 'bot');
        } else if (t.includes('lelah') || t.includes('capek') || t.includes('burnout')) {
            addBubble("Kedengaran sangat lelah. Istirahat teratur dan batasan kerja bisa membantu. Apakah tekanan ini berasal dari pekerjaan?", 'bot');
        } else if (t.includes('tidur')) {
            addBubble("Masalah tidur sering memengaruhi mood. Coba rutinitas tidur yang teratur.", 'bot');
        } else {
            addBubble("Terima kasih sudah berbagi. Boleh ceritakan kapan mulai merasa begini?", 'bot');
        }
      }

      if (sendBtn) {
        sendBtn.addEventListener('click', () => {
          const txt = storyInput.value.trim();
          if(!txt) return;
          addBubble(txt, 'user');
          storyInput.value = '';
          processAI(txt);
        });
        storyInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') sendBtn.click(); });
        clearBtn.addEventListener('click', () => { history.innerHTML = '<div class="bubble bot">Halo! Aku MindBloow AI. Chat sudah dibersihkan.</div>'; });
        document.querySelectorAll('.quick').forEach(btn => {
          btn.addEventListener('click', () => { 
            // Mengambil teks tombol tanpa emoji untuk input
            let btnText = btn.innerText.replace(/[\uD800-\uDBFF\uDC00-\uDFFF]/g, '').trim(); 
            storyInput.value = btnText; 
            sendBtn.click(); 
          });
        });
      }

      // Edu Accordion
      document.querySelectorAll('.disorder').forEach(d => {
        d.querySelector('.disorder-header').addEventListener('click', () => {
          d.classList.toggle('open');
          const t = d.querySelector('.toggle');
          if(t) t.innerText = d.classList.contains('open') ? 'Tutup' : 'Buka detail';
        });
      });
    });
  </script>
</body>
</html>